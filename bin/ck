#!/usr/bin/env python3
import argparse
from customkey.hotkey import CustomHotkey
from customkey.hotkey import Fzf
import time
import sys

if __name__ == "__main__":

    parser = argparse.ArgumentParser(
        description="Customhotkey.."
    )
    parser.add_argument("--debug", action="store_true", help="Turn on Debug Mode")
    parser.add_argument(
        "--init",
        action="store_true",
        help="Initialize Customhotkey with dummy config file",
        default=None,
    )

    parser.add_argument(
        "--run",
        action="store_true",
        help="Run custom hotkey",
    )

    parser.add_argument(
        "--edit",
        action="store_true",
        help="Edit custom hotkey config",
    )

    args = parser.parse_args()

    fzf = Fzf()

    if args.debug:
        pass

    if args.run:
        app = CustomHotkey()
        while True:
            try:
                app.enter_loop()
            except OSError:
                time.sleep(15)
                pass
    if args.init:
        hk = CustomHotkey()
        try:
            hk.setup()
        except KeyboardInterrupt:
            sys.exit(0)
        sys.exit(0)

    if args.edit:
        hk = CustomHotkey()
        hk.edit_config()

    function = fzf.prompt(
        [   "execute_cmd",
            "edit_config"
        ],
        "--cycle --reverse --header=Choose function to use",
    )
    if "execute_cmd" in function:
        pass
    if "edit_config" in function:
        hk = CustomHotkey()
        hk.edit_config()
